<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MS-900 Practice Exam #2 - Standard Difficulty</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            color: #333;
        }

        .exam-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
        }

        .header {
            background: #0078d4;
            color: white;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 20px;
            font-weight: 600;
        }

        .timer {
            font-size: 18px;
            font-weight: bold;
            padding: 8px 16px;
            background: rgba(255,255,255,0.2);
            border-radius: 4px;
        }

        .timer.warning {
            background: #dc3545;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .progress-bar {
            height: 8px;
            background: #e0e0e0;
        }

        .progress-fill {
            height: 100%;
            background: #0078d4;
            transition: width 0.3s ease;
        }

        .main-content {
            display: flex;
            min-height: calc(100vh - 150px);
        }

        .question-nav {
            width: 200px;
            background: #fafafa;
            padding: 20px;
            border-right: 1px solid #e0e0e0;
            overflow-y: auto;
        }

        .question-nav h3 {
            font-size: 14px;
            margin-bottom: 15px;
            color: #666;
        }

        .nav-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
        }

        .nav-item {
            width: 32px;
            height: 32px;
            border: 2px solid #ccc;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .nav-item:hover {
            border-color: #0078d4;
        }

        .nav-item.current {
            background: #0078d4;
            color: white;
            border-color: #0078d4;
        }

        .nav-item.answered {
            background: #28a745;
            color: white;
            border-color: #28a745;
        }

        .nav-item.flagged {
            background: #ffc107;
            color: #333;
            border-color: #ffc107;
        }

        .question-area {
            flex: 1;
            padding: 40px;
            overflow-y: auto;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e0e0e0;
        }

        .question-number {
            font-size: 16px;
            font-weight: 600;
            color: #666;
        }

        .flag-btn {
            padding: 8px 20px;
            background: white;
            border: 2px solid #ffc107;
            color: #333;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .flag-btn:hover {
            background: #ffc107;
        }

        .flag-btn.flagged {
            background: #ffc107;
        }

        .question-text {
            font-size: 18px;
            line-height: 1.6;
            margin-bottom: 30px;
            font-weight: 500;
        }

        .case-study {
            background: #f8f9fa;
            border-left: 4px solid #0078d4;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 4px;
        }

        .case-study h4 {
            margin-bottom: 15px;
            color: #0078d4;
        }

        .options {
            margin-top: 25px;
        }

        .option {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            padding: 15px 20px;
            margin-bottom: 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
        }

        .option:hover {
            border-color: #0078d4;
            background: #e7f3ff;
        }

        .option.selected {
            background: #0078d4;
            border-color: #0078d4;
            color: white;
        }

        .option input[type="radio"],
        .option input[type="checkbox"] {
            margin-right: 15px;
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .drag-drop-area {
            display: flex;
            gap: 30px;
            margin-top: 25px;
        }

        .drag-items {
            flex: 1;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 6px;
        }

        .drag-items h4 {
            margin-bottom: 15px;
            color: #666;
        }

        .drag-item {
            background: white;
            border: 2px solid #0078d4;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 4px;
            cursor: move;
            font-size: 14px;
        }

        .drop-zones {
            flex: 1;
        }

        .drop-zone {
            background: #f8f9fa;
            border: 2px dashed #ccc;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 6px;
            min-height: 50px;
        }

        .drop-zone.drag-over {
            background: #e7f3ff;
            border-color: #0078d4;
        }

        .drop-zone .drag-item {
            cursor: pointer;
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid #e0e0e0;
        }

        .nav-btn {
            padding: 12px 30px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .nav-btn.previous {
            background: #6c757d;
            color: white;
        }

        .nav-btn.previous:hover {
            background: #5a6268;
        }

        .nav-btn.previous:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .nav-btn.next {
            background: #0078d4;
            color: white;
        }

        .nav-btn.next:hover {
            background: #006cbd;
        }

        .nav-btn.submit {
            background: #28a745;
            color: white;
        }

        .nav-btn.submit:hover {
            background: #218838;
        }

        .results-screen {
            display: none;
            padding: 40px;
            text-align: center;
        }

        .results-screen.active {
            display: block;
        }

        .score-display {
            font-size: 72px;
            font-weight: bold;
            color: #0078d4;
            margin: 30px 0;
        }

        .pass-fail {
            font-size: 36px;
            font-weight: bold;
            margin: 20px 0;
        }

        .pass-fail.pass {
            color: #28a745;
        }

        .pass-fail.fail {
            color: #dc3545;
        }

        .section-breakdown {
            max-width: 800px;
            margin: 40px auto;
            text-align: left;
        }

        .section-item {
            background: #f8f9fa;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 6px;
            border-left: 4px solid #0078d4;
        }

        .section-name {
            font-weight: 600;
            margin-bottom: 10px;
        }

        .section-bar {
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 10px;
        }

        .section-bar-fill {
            height: 100%;
            background: #0078d4;
            transition: width 0.5s ease;
        }

        .restart-btn {
            margin-top: 30px;
            padding: 15px 40px;
            background: #0078d4;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
        }

        .restart-btn:hover {
            background: #006cbd;
        }

        .instructions {
            background: #fff3cd;
            border: 1px solid #ffc107;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 6px;
        }

        .instructions h3 {
            color: #856404;
            margin-bottom: 10px;
        }

        .instructions p {
            color: #856404;
            line-height: 1.6;
        }

        .difficulty-badge {
            background: #28a745;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 15px;
        }

        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }

            .question-nav {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid #e0e0e0;
            }

            .question-area {
                padding: 20px;
            }

            .drag-drop-area {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="exam-container">
        <div class="header">
            <div style="display: flex; align-items: center;">
                <h1>MS-900: Microsoft 365 Fundamentals - Practice Exam #2</h1>
                <span class="difficulty-badge">STANDARD</span>
            </div>
            <div class="timer" id="timer">50:00</div>
        </div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="progressBar"></div>
        </div>

        <div class="main-content" id="examContent">
            <div class="question-nav">
                <h3>Questions</h3>
                <div class="nav-grid" id="navGrid"></div>
            </div>

            <div class="question-area" id="questionArea"></div>
        </div>

        <div class="results-screen" id="resultsScreen"></div>
    </div>

    <script>
        // Exam questions data - STANDARD DIFFICULTY
        const examData = {
            totalTime: 50 * 60, // 50 minutes in seconds
            passingScore: 700,
            questions: [
                // SECTION 1: Identity and Access Management (15 questions - STANDARD)
                {
                    id: 1,
                    type: 'multiple-choice',
                    text: 'What does MFA stand for in Microsoft 365?',
                    options: [
                        'Microsoft File Access',
                        'Multi-Factor Authentication',
                        'Managed Firewall Application',
                        'Multiple Form Authorization'
                    ],
                    correctAnswer: 1,
                    section: 'Identity and Access Management',
                    explanation: 'MFA stands for Multi-Factor Authentication, which requires users to provide two or more verification methods to access resources.'
                },
                {
                    id: 2,
                    type: 'true-false',
                    text: 'Microsoft Entra ID (formerly Azure AD) is a cloud-based identity and access management service.',
                    correctAnswer: true,
                    section: 'Identity and Access Management',
                    explanation: 'True. Microsoft Entra ID is Microsoft\'s cloud-based identity and access management service that helps users sign in and access resources.'
                },
                {
                    id: 3,
                    type: 'multiple-choice',
                    text: 'Which authentication method is considered more secure than just using a password?',
                    options: [
                        'Using a longer password',
                        'Using Multi-Factor Authentication (MFA)',
                        'Using a username',
                        'Using email verification only'
                    ],
                    correctAnswer: 1,
                    section: 'Identity and Access Management',
                    explanation: 'MFA is more secure because it requires multiple forms of verification, making it harder for attackers to gain access even if they have your password.'
                },
                {
                    id: 4,
                    type: 'multiple-choice',
                    text: 'What is the purpose of Self-Service Password Reset (SSPR)?',
                    options: [
                        'To allow IT administrators to reset all passwords',
                        'To allow users to reset their own passwords without calling the helpdesk',
                        'To automatically change passwords every month',
                        'To remove password requirements'
                    ],
                    correctAnswer: 1,
                    section: 'Identity and Access Management',
                    explanation: 'SSPR allows users to reset their own passwords without contacting IT support, reducing helpdesk workload and improving user experience.'
                },
                {
                    id: 5,
                    type: 'true-false',
                    text: 'Conditional Access policies can block access based on user location.',
                    correctAnswer: true,
                    section: 'Identity and Access Management',
                    explanation: 'True. Conditional Access can use location as a signal to grant or block access to resources.'
                },
                {
                    id: 6,
                    type: 'multiple-choice',
                    text: 'Which role in Microsoft Entra ID has the most permissions?',
                    options: [
                        'User Administrator',
                        'Security Administrator',
                        'Global Administrator',
                        'Billing Administrator'
                    ],
                    correctAnswer: 2,
                    section: 'Identity and Access Management',
                    explanation: 'Global Administrator is the highest-level role with full access to all administrative features in Microsoft 365.'
                },
                {
                    id: 7,
                    type: 'multiple-choice',
                    text: 'What is a guest user in Microsoft Entra ID?',
                    options: [
                        'A temporary employee account',
                        'An external user invited to collaborate',
                        'A user without a password',
                        'An administrator account'
                    ],
                    correctAnswer: 1,
                    section: 'Identity and Access Management',
                    explanation: 'Guest users are external users (from other organizations) who are invited to collaborate with your organization\'s resources.'
                },
                {
                    id: 8,
                    type: 'drag-drop',
                    text: 'Match each term to its definition:',
                    items: [
                        'MFA',
                        'SSO',
                        'SSPR',
                        'RBAC'
                    ],
                    zones: [
                        'Users sign in once and access multiple applications',
                        'Users verify identity with two or more methods',
                        'Users reset their own passwords',
                        'Assigns permissions based on user roles'
                    ],
                    correctMapping: {
                        'MFA': 'Users verify identity with two or more methods',
                        'SSO': 'Users sign in once and access multiple applications',
                        'SSPR': 'Users reset their own passwords',
                        'RBAC': 'Assigns permissions based on user roles'
                    },
                    section: 'Identity and Access Management'
                },
                {
                    id: 9,
                    type: 'multiple-choice',
                    text: 'Which of the following is NOT a common MFA verification method?',
                    options: [
                        'Text message (SMS)',
                        'Phone call',
                        'Authenticator app',
                        'Social media verification'
                    ],
                    correctAnswer: 3,
                    section: 'Identity and Access Management',
                    explanation: 'Social media verification is not a standard MFA method. Common methods include SMS, phone calls, authenticator apps, and security keys.'
                },
                {
                    id: 10,
                    type: 'true-false',
                    text: 'Security Defaults in Microsoft Entra ID require MFA for all users.',
                    correctAnswer: true,
                    section: 'Identity and Access Management',
                    explanation: 'True. Security Defaults is a baseline security feature that requires MFA for all users to improve security posture.'
                },
                {
                    id: 11,
                    type: 'multiple-choice',
                    text: 'What is the main purpose of Conditional Access?',
                    options: [
                        'To create user accounts',
                        'To control access based on conditions like location, device, or risk',
                        'To delete old files',
                        'To send email notifications'
                    ],
                    correctAnswer: 1,
                    section: 'Identity and Access Management',
                    explanation: 'Conditional Access creates policies that grant or block access based on specific conditions and signals.'
                },
                {
                    id: 12,
                    type: 'multiple-choice',
                    text: 'Which feature helps protect against compromised user credentials?',
                    options: [
                        'Password expiration',
                        'Microsoft Entra ID Protection',
                        'Longer usernames',
                        'Email filters'
                    ],
                    correctAnswer: 1,
                    section: 'Identity and Access Management',
                    explanation: 'Microsoft Entra ID Protection detects and responds to identity-based risks, including compromised credentials.'
                },
                {
                    id: 13,
                    type: 'true-false',
                    text: 'Single Sign-On (SSO) allows users to access multiple applications with one set of credentials.',
                    correctAnswer: true,
                    section: 'Identity and Access Management',
                    explanation: 'True. SSO enables users to sign in once and access multiple applications without re-entering credentials.'
                },
                {
                    id: 14,
                    type: 'multiple-choice',
                    text: 'What does Azure AD Connect do?',
                    options: [
                        'Connects users to the internet',
                        'Synchronizes on-premises Active Directory with Microsoft Entra ID',
                        'Creates backup copies of files',
                        'Monitors network traffic'
                    ],
                    correctAnswer: 1,
                    section: 'Identity and Access Management',
                    explanation: 'Azure AD Connect (now Microsoft Entra Connect) synchronizes on-premises Active Directory identities to the cloud.'
                },
                {
                    id: 15,
                    type: 'multiple-select',
                    text: 'Which of the following are benefits of using MFA? (Select all that apply)',
                    options: [
                        'Increased security',
                        'Protection against password theft',
                        'Reduced risk of account compromise',
                        'Faster login times',
                        'Better compliance with security policies'
                    ],
                    correctAnswers: [0, 1, 2, 4],
                    section: 'Identity and Access Management',
                    explanation: 'MFA provides increased security, protects against password theft, reduces compromise risk, and helps meet compliance requirements. It may add a few seconds to login time.'
                },

                // SECTION 2: Productivity Solutions (12 questions - STANDARD)
                {
                    id: 16,
                    type: 'multiple-choice',
                    text: 'Which Microsoft 365 app is used for creating spreadsheets and analyzing data?',
                    options: [
                        'Microsoft Word',
                        'Microsoft Excel',
                        'Microsoft PowerPoint',
                        'Microsoft Access'
                    ],
                    correctAnswer: 1,
                    section: 'Productivity Solutions',
                    explanation: 'Microsoft Excel is the spreadsheet application used for data analysis, calculations, and creating charts.'
                },
                {
                    id: 17,
                    type: 'true-false',
                    text: 'Microsoft OneNote is a digital notebook application for taking and organizing notes.',
                    correctAnswer: true,
                    section: 'Productivity Solutions',
                    explanation: 'True. OneNote is designed for capturing and organizing notes, including text, images, audio, and drawings.'
                },
                {
                    id: 18,
                    type: 'drag-drop',
                    text: 'Match each app to what it\'s primarily used for:',
                    items: [
                        'Word',
                        'PowerPoint',
                        'Outlook',
                        'OneNote'
                    ],
                    zones: [
                        'Creating presentations',
                        'Writing documents',
                        'Managing email and calendar',
                        'Taking notes'
                    ],
                    correctMapping: {
                        'Word': 'Writing documents',
                        'PowerPoint': 'Creating presentations',
                        'Outlook': 'Managing email and calendar',
                        'OneNote': 'Taking notes'
                    },
                    section: 'Productivity Solutions'
                },
                {
                    id: 19,
                    type: 'multiple-choice',
                    text: 'What is Microsoft Planner used for?',
                    options: [
                        'Creating spreadsheets',
                        'Managing tasks and projects',
                        'Editing photos',
                        'Recording videos'
                    ],
                    correctAnswer: 1,
                    section: 'Productivity Solutions',
                    explanation: 'Microsoft Planner is a task management tool for organizing team work with boards, tasks, and deadlines.'
                },
                {
                    id: 20,
                    type: 'true-false',
                    text: 'Microsoft 365 Apps can be accessed from a web browser.',
                    correctAnswer: true,
                    section: 'Productivity Solutions',
                    explanation: 'True. Microsoft 365 Apps are available in web versions through Office Online, accessible from any browser.'
                },
                {
                    id: 21,
                    type: 'multiple-choice',
                    text: 'Which app would you use to create a slideshow presentation?',
                    options: [
                        'Microsoft Word',
                        'Microsoft Excel',
                        'Microsoft PowerPoint',
                        'Microsoft Publisher'
                    ],
                    correctAnswer: 2,
                    section: 'Productivity Solutions',
                    explanation: 'PowerPoint is the Microsoft 365 application for creating slide presentations.'
                },
                {
                    id: 22,
                    type: 'multiple-choice',
                    text: 'What is Microsoft Forms used for?',
                    options: [
                        'Creating surveys and quizzes',
                        'Managing files',
                        'Sending emails',
                        'Video conferencing'
                    ],
                    correctAnswer: 0,
                    section: 'Productivity Solutions',
                    explanation: 'Microsoft Forms is a tool for creating surveys, polls, and quizzes to collect information and feedback.'
                },
                {
                    id: 23,
                    type: 'true-false',
                    text: 'Microsoft To Do helps users create and manage personal task lists.',
                    correctAnswer: true,
                    section: 'Productivity Solutions',
                    explanation: 'True. Microsoft To Do is a personal task management app for creating to-do lists and tracking tasks.'
                },
                {
                    id: 24,
                    type: 'multiple-select',
                    text: 'Which features are available in Microsoft Word? (Select all that apply)',
                    options: [
                        'Spell check and grammar check',
                        'Track changes for collaboration',
                        'Creating charts and graphs',
                        'Templates for documents',
                        'Real-time co-authoring'
                    ],
                    correctAnswers: [0, 1, 3, 4],
                    section: 'Productivity Solutions',
                    explanation: 'Word includes spell/grammar check, track changes, templates, and co-authoring. Charts and graphs are primarily an Excel feature, though Word can insert them.'
                },
                {
                    id: 25,
                    type: 'multiple-choice',
                    text: 'Which Microsoft 365 app manages your email and calendar?',
                    options: [
                        'Microsoft Teams',
                        'Microsoft Outlook',
                        'Microsoft OneNote',
                        'Microsoft Bookings'
                    ],
                    correctAnswer: 1,
                    section: 'Productivity Solutions',
                    explanation: 'Microsoft Outlook is the email and calendar management application in Microsoft 365.'
                },
                {
                    id: 26,
                    type: 'multiple-choice',
                    text: 'What is Microsoft Bookings designed for?',
                    options: [
                        'Reading e-books',
                        'Scheduling appointments with customers',
                        'Keeping financial records',
                        'Creating newsletters'
                    ],
                    correctAnswer: 1,
                    section: 'Productivity Solutions',
                    explanation: 'Microsoft Bookings is an appointment scheduling tool that helps businesses manage customer bookings and calendars.'
                },
                {
                    id: 27,
                    type: 'true-false',
                    text: 'Microsoft Lists helps teams track information and organize work.',
                    correctAnswer: true,
                    section: 'Productivity Solutions',
                    explanation: 'True. Microsoft Lists is an app for tracking information, organizing work, and managing workflows with customizable lists.'
                },

                // SECTION 3: Collaboration Solutions (12 questions - STANDARD)
                {
                    id: 28,
                    type: 'multiple-choice',
                    text: 'What is Microsoft Teams primarily used for?',
                    options: [
                        'Data analysis',
                        'Team chat, meetings, and collaboration',
                        'Photo editing',
                        'Database management'
                    ],
                    correctAnswer: 1,
                    section: 'Collaboration Solutions',
                    explanation: 'Microsoft Teams is a collaboration platform for chat, video meetings, file sharing, and teamwork.'
                },
                {
                    id: 29,
                    type: 'true-false',
                    text: 'OneDrive for Business provides cloud storage for personal work files.',
                    correctAnswer: true,
                    section: 'Collaboration Solutions',
                    explanation: 'True. OneDrive for Business gives each user personal cloud storage for their files that can be accessed from anywhere.'
                },
                {
                    id: 30,
                    type: 'multiple-choice',
                    text: 'Which service is best for creating a company intranet site?',
                    options: [
                        'OneDrive',
                        'Outlook',
                        'SharePoint',
                        'Teams'
                    ],
                    correctAnswer: 2,
                    section: 'Collaboration Solutions',
                    explanation: 'SharePoint is designed for creating intranet sites, team sites, and managing organizational content.'
                },
                {
                    id: 31,
                    type: 'drag-drop',
                    text: 'Match each collaboration tool to its primary use:',
                    items: [
                        'Teams',
                        'SharePoint',
                        'OneDrive',
                        'Yammer'
                    ],
                    zones: [
                        'Personal file storage',
                        'Real-time team communication',
                        'Company-wide social networking',
                        'Team sites and document libraries'
                    ],
                    correctMapping: {
                        'Teams': 'Real-time team communication',
                        'SharePoint': 'Team sites and document libraries',
                        'OneDrive': 'Personal file storage',
                        'Yammer': 'Company-wide social networking'
                    },
                    section: 'Collaboration Solutions'
                },
                {
                    id: 32,
                    type: 'true-false',
                    text: 'You can have video meetings with screen sharing in Microsoft Teams.',
                    correctAnswer: true,
                    section: 'Collaboration Solutions',
                    explanation: 'True. Teams supports video meetings with features like screen sharing, recording, and virtual backgrounds.'
                },
                {
                    id: 33,
                    type: 'multiple-choice',
                    text: 'Where are files shared in a Teams channel stored?',
                    options: [
                        'In Outlook',
                        'In SharePoint',
                        'On local computers only',
                        'In Exchange Online'
                    ],
                    correctAnswer: 1,
                    section: 'Collaboration Solutions',
                    explanation: 'Files shared in Teams channels are automatically stored in SharePoint, providing enterprise-grade storage and management.'
                },
                {
                    id: 34,
                    type: 'multiple-choice',
                    text: 'What is the main difference between a public and private team in Microsoft Teams?',
                    options: [
                        'Public teams are visible to everyone; private teams require permission',
                        'Public teams cost more',
                        'Private teams can\'t have meetings',
                        'There is no difference'
                    ],
                    correctAnswer: 0,
                    section: 'Collaboration Solutions',
                    explanation: 'Public teams are discoverable and anyone in the organization can join, while private teams are hidden and require an invitation.'
                },
                {
                    id: 35,
                    type: 'true-false',
                    text: 'Multiple people can edit the same document at the same time in Microsoft 365.',
                    correctAnswer: true,
                    section: 'Collaboration Solutions',
                    explanation: 'True. Microsoft 365 supports real-time co-authoring in Word, Excel, PowerPoint, and other apps.'
                },
                {
                    id: 36,
                    type: 'multiple-select',
                    text: 'Which features are available in Microsoft Teams? (Select all that apply)',
                    options: [
                        'Chat messaging',
                        'Video meetings',
                        'File sharing',
                        'Spreadsheet formulas',
                        'Channel conversations'
                    ],
                    correctAnswers: [0, 1, 2, 4],
                    section: 'Collaboration Solutions',
                    explanation: 'Teams provides chat, video meetings, file sharing, and channel conversations. Spreadsheet formulas are an Excel feature.'
                },
                {
                    id: 37,
                    type: 'multiple-choice',
                    text: 'What is Microsoft Stream used for?',
                    options: [
                        'Streaming music',
                        'Sharing and managing videos',
                        'Live TV broadcasting',
                        'Social media posting'
                    ],
                    correctAnswer: 1,
                    section: 'Collaboration Solutions',
                    explanation: 'Microsoft Stream (now integrated with SharePoint) is for uploading, sharing, and managing organizational videos.'
                },
                {
                    id: 38,
                    type: 'multiple-choice',
                    text: 'Which app can be integrated into Teams channels to manage tasks?',
                    options: [
                        'Microsoft Planner',
                        'Microsoft Paint',
                        'Windows Media Player',
                        'Notepad'
                    ],
                    correctAnswer: 0,
                    section: 'Collaboration Solutions',
                    explanation: 'Microsoft Planner can be added as a tab in Teams channels to manage team tasks and projects.'
                },
                {
                    id: 39,
                    type: 'true-false',
                    text: 'SharePoint allows you to set permissions on who can access specific files and folders.',
                    correctAnswer: true,
                    section: 'Collaboration Solutions',
                    explanation: 'True. SharePoint provides granular permission controls for managing access to content at various levels.'
                },

                // SECTION 4: Security and Compliance (4 questions - STANDARD)
                {
                    id: 40,
                    type: 'multiple-choice',
                    text: 'What is the purpose of Microsoft Defender for Office 365?',
                    options: [
                        'To backup emails',
                        'To protect against email threats like phishing and malware',
                        'To organize calendar events',
                        'To create email signatures'
                    ],
                    correctAnswer: 1,
                    section: 'Security and Compliance',
                    explanation: 'Microsoft Defender for Office 365 protects against threats in email, including phishing, malware, and spam.'
                },
                {
                    id: 41,
                    type: 'true-false',
                    text: 'Data Loss Prevention (DLP) helps prevent sensitive information from being shared inappropriately.',
                    correctAnswer: true,
                    section: 'Security and Compliance',
                    explanation: 'True. DLP policies identify, monitor, and protect sensitive data to prevent accidental or intentional data leaks.'
                },
                {
                    id: 42,
                    type: 'multiple-choice',
                    text: 'What is Microsoft Secure Score?',
                    options: [
                        'A test score for users',
                        'A measurement of your organization\'s security posture',
                        'A password strength indicator',
                        'A file encryption level'
                    ],
                    correctAnswer: 1,
                    section: 'Security and Compliance',
                    explanation: 'Microsoft Secure Score measures an organization\'s security posture and provides recommendations for improvement.'
                },
                {
                    id: 43,
                    type: 'multiple-choice',
                    text: 'What does Zero Trust security mean?',
                    options: [
                        'Trust no one inside or outside the network',
                        'Never use passwords',
                        'Block all internet access',
                        'Only trust administrators'
                    ],
                    correctAnswer: 0,
                    section: 'Security and Compliance',
                    explanation: 'Zero Trust assumes no automatic trust and continuously verifies every access request, regardless of where it comes from.'
                },

                // SECTION 5: Pricing and Licensing (2 questions - STANDARD)
                {
                    id: 44,
                    type: 'multiple-choice',
                    text: 'How are Microsoft 365 subscriptions typically billed?',
                    options: [
                        'Per hour',
                        'Monthly or annually',
                        'Every 5 years',
                        'One-time purchase only'
                    ],
                    correctAnswer: 1,
                    section: 'Pricing and Licensing',
                    explanation: 'Microsoft 365 subscriptions are typically billed on a monthly or annual basis per user.'
                },
                {
                    id: 45,
                    type: 'true-false',
                    text: 'Microsoft 365 Business plans are designed for small to medium-sized organizations (up to 300 users).',
                    correctAnswer: true,
                    section: 'Pricing and Licensing',
                    explanation: 'True. Microsoft 365 Business plans are designed for organizations with up to 300 users. Larger organizations typically use Enterprise plans.'
                }
            ]
        };

        // Exam state
        let currentQuestion = 0;
        let answers = {};
        let flagged = new Set();
        let timeRemaining = examData.totalTime;
        let timerInterval;
        let examStarted = false;

        // Initialize exam
        function initExam() {
            renderNavigation();
            renderQuestion();
            startTimer();
            updateProgress();
            examStarted = true;
        }

        // Timer function
        function startTimer() {
            timerInterval = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    submitExam();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            const display = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            const timerEl = document.getElementById('timer');
            timerEl.textContent = display;
            
            if (timeRemaining <= 300) { // 5 minutes warning
                timerEl.classList.add('warning');
            }
        }

        // Navigation
        function renderNavigation() {
            const navGrid = document.getElementById('navGrid');
            navGrid.innerHTML = '';
            
            examData.questions.forEach((q, index) => {
                const navItem = document.createElement('div');
                navItem.className = 'nav-item';
                navItem.textContent = index + 1;
                
                if (index === currentQuestion) {
                    navItem.classList.add('current');
                }
                if (answers[q.id] !== undefined && answers[q.id] !== null) {
                    navItem.classList.add('answered');
                }
                if (flagged.has(q.id)) {
                    navItem.classList.add('flagged');
                }
                
                navItem.onclick = () => goToQuestion(index);
                navGrid.appendChild(navItem);
            });
        }

        function goToQuestion(index) {
            currentQuestion = index;
            renderQuestion();
            renderNavigation();
            updateProgress();
        }

        function updateProgress() {
            const progress = ((currentQuestion + 1) / examData.questions.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
        }

        // Question rendering
        function renderQuestion() {
            const question = examData.questions[currentQuestion];
            const questionArea = document.getElementById('questionArea');
            
            let html = `
                <div class="question-header">
                    <div class="question-number">Question ${currentQuestion + 1} of ${examData.questions.length}</div>
                    <button class="flag-btn ${flagged.has(question.id) ? 'flagged' : ''}" onclick="toggleFlag()">
                        ${flagged.has(question.id) ? '⚑ Flagged' : '⚐ Flag for Review'}
                    </button>
                </div>
            `;

            html += `<div class="question-text">${question.text}</div>`;

            if (question.type === 'multiple-choice' || question.type === 'true-false') {
                html += '<div class="options">';
                const options = question.type === 'true-false' ? ['True', 'False'] : question.options;
                options.forEach((option, index) => {
                    const isSelected = question.type === 'true-false' 
                        ? answers[question.id] === (index === 0)
                        : answers[question.id] === index;
                    
                    html += `
                        <div class="option ${isSelected ? 'selected' : ''}" onclick="selectOption(${index})">
                            <input type="radio" name="q${question.id}" ${isSelected ? 'checked' : ''}>
                            <span>${option}</span>
                        </div>
                    `;
                });
                html += '</div>';
            } else if (question.type === 'multiple-select') {
                html += '<div class="instructions"><h3>Instructions</h3><p>Select all answers that apply.</p></div>';
                html += '<div class="options">';
                question.options.forEach((option, index) => {
                    const isSelected = answers[question.id]?.includes(index) || false;
                    html += `
                        <div class="option ${isSelected ? 'selected' : ''}" onclick="toggleMultiSelect(${index})">
                            <input type="checkbox" ${isSelected ? 'checked' : ''}>
                            <span>${option}</span>
                        </div>
                    `;
                });
                html += '</div>';
            } else if (question.type === 'drag-drop') {
                html += `
                    <div class="instructions">
                        <h3>Instructions</h3>
                        <p>Drag items from the left to match them with the correct descriptions on the right.</p>
                    </div>
                    <div class="drag-drop-area">
                        <div class="drag-items">
                            <h4>Items to Match</h4>
                            <div id="dragItems"></div>
                        </div>
                        <div class="drop-zones">
                            <h4>Descriptions</h4>
                            <div id="dropZones"></div>
                        </div>
                    </div>
                `;
            }

            html += `
                <div class="navigation-buttons">
                    <button class="nav-btn previous" onclick="previousQuestion()" ${currentQuestion === 0 ? 'disabled' : ''}>
                        ← Previous
                    </button>
                    ${currentQuestion === examData.questions.length - 1 
                        ? '<button class="nav-btn submit" onclick="confirmSubmit()">Submit Exam</button>'
                        : '<button class="nav-btn next" onclick="nextQuestion()">Next →</button>'
                    }
                </div>
            `;

            questionArea.innerHTML = html;

            if (question.type === 'drag-drop') {
                renderDragDrop(question);
            }
        }

        function renderDragDrop(question) {
            const dragItems = document.getElementById('dragItems');
            const dropZones = document.getElementById('dropZones');
            
            if (!answers[question.id]) {
                answers[question.id] = {};
            }
            
            const usedItems = new Set(Object.keys(answers[question.id]));
            question.items.forEach(item => {
                if (!usedItems.has(item)) {
                    const div = document.createElement('div');
                    div.className = 'drag-item';
                    div.draggable = true;
                    div.textContent = item;
                    div.ondragstart = (e) => e.dataTransfer.setData('text', item);
                    dragItems.appendChild(div);
                }
            });
            
            question.zones.forEach(zone => {
                const div = document.createElement('div');
                div.className = 'drop-zone';
                div.innerHTML = `<strong>${zone}</strong>`;
                
                const assignedItem = Object.keys(answers[question.id]).find(
                    item => answers[question.id][item] === zone
                );
                
                if (assignedItem) {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'drag-item';
                    itemDiv.draggable = true;
                    itemDiv.textContent = assignedItem;
                    itemDiv.ondragstart = (e) => {
                        e.dataTransfer.setData('text', assignedItem);
                        delete answers[question.id][assignedItem];
                    };
                    itemDiv.onclick = () => {
                        delete answers[question.id][assignedItem];
                        renderQuestion();
                    };
                    div.appendChild(itemDiv);
                }
                
                div.ondragover = (e) => {
                    e.preventDefault();
                    div.classList.add('drag-over');
                };
                div.ondragleave = () => div.classList.remove('drag-over');
                div.ondrop = (e) => {
                    e.preventDefault();
                    div.classList.remove('drag-over');
                    const item = e.dataTransfer.getData('text');
                    answers[question.id][item] = zone;
                    renderQuestion();
                    renderNavigation();
                };
                
                dropZones.appendChild(div);
            });
        }

        function selectOption(index) {
            const question = examData.questions[currentQuestion];
            answers[question.id] = index;
            renderQuestion();
            renderNavigation();
        }

        function toggleMultiSelect(index) {
            const question = examData.questions[currentQuestion];
            if (!answers[question.id]) {
                answers[question.id] = [];
            }
            
            const answerIndex = answers[question.id].indexOf(index);
            if (answerIndex > -1) {
                answers[question.id].splice(answerIndex, 1);
            } else {
                answers[question.id].push(index);
            }
            
            renderQuestion();
            renderNavigation();
        }

        function toggleFlag() {
            const question = examData.questions[currentQuestion];
            if (flagged.has(question.id)) {
                flagged.delete(question.id);
            } else {
                flagged.add(question.id);
            }
            renderQuestion();
            renderNavigation();
        }

        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                renderQuestion();
                renderNavigation();
                updateProgress();
            }
        }

        function nextQuestion() {
            if (currentQuestion < examData.questions.length - 1) {
                currentQuestion++;
                renderQuestion();
                renderNavigation();
                updateProgress();
            }
        }

        function confirmSubmit() {
            const unanswered = examData.questions.filter(q => 
                answers[q.id] === undefined || answers[q.id] === null || 
                (Array.isArray(answers[q.id]) && answers[q.id].length === 0) ||
                (typeof answers[q.id] === 'object' && Object.keys(answers[q.id]).length === 0)
            ).length;
            
            let message = 'Are you sure you want to submit your exam?';
            if (unanswered > 0) {
                message += `\n\nYou have ${unanswered} unanswered question(s).`;
            }
            
            if (confirm(message)) {
                submitExam();
            }
        }

        function submitExam() {
            clearInterval(timerInterval);
            
            let totalPoints = 0;
            let earnedPoints = 0;
            const sectionScores = {};
            
            examData.questions.forEach(question => {
                totalPoints += 1000 / examData.questions.length;
                
                if (!sectionScores[question.section]) {
                    sectionScores[question.section] = { total: 0, earned: 0 };
                }
                sectionScores[question.section].total += 1;
                
                let isCorrect = false;
                
                if (question.type === 'multiple-choice') {
                    isCorrect = answers[question.id] === question.correctAnswer;
                } else if (question.type === 'true-false') {
                    isCorrect = answers[question.id] === question.correctAnswer;
                } else if (question.type === 'multiple-select') {
                    const userAnswers = answers[question.id] || [];
                    isCorrect = JSON.stringify(userAnswers.sort()) === JSON.stringify(question.correctAnswers.sort());
                } else if (question.type === 'drag-drop') {
                    const userMapping = answers[question.id] || {};
                    isCorrect = Object.keys(question.correctMapping).every(
                        item => userMapping[item] === question.correctMapping[item]
                    );
                }
                
                if (isCorrect) {
                    earnedPoints += 1000 / examData.questions.length;
                    sectionScores[question.section].earned += 1;
                }
            });
            
            const finalScore = Math.round(earnedPoints);
            const passed = finalScore >= examData.passingScore;
            
            displayResults(finalScore, passed, sectionScores);
        }

        function displayResults(score, passed, sectionScores) {
            document.getElementById('examContent').style.display = 'none';
            const resultsScreen = document.getElementById('resultsScreen');
            resultsScreen.classList.add('active');
            
            let html = `
                <h2>Exam Complete!</h2>
                <div class="score-display">${score}</div>
                <div class="pass-fail ${passed ? 'pass' : 'fail'}">
                    ${passed ? '✓ PASSED' : '✗ DID NOT PASS'}
                </div>
                <p style="font-size: 18px; margin: 20px 0;">
                    Passing Score: ${examData.passingScore} | Your Score: ${score}
                </p>
                
                <div class="section-breakdown">
                    <h3 style="margin-bottom: 20px;">Performance by Section</h3>
            `;
            
            Object.keys(sectionScores).forEach(section => {
                const data = sectionScores[section];
                const percentage = (data.earned / data.total * 100).toFixed(1);
                html += `
                    <div class="section-item">
                        <div class="section-name">${section}</div>
                        <div>${data.earned} of ${data.total} correct (${percentage}%)</div>
                        <div class="section-bar">
                            <div class="section-bar-fill" style="width: ${percentage}%"></div>
                        </div>
                    </div>
                `;
            });
            
            html += `
                </div>
                
                <div style="margin-top: 40px; padding: 20px; background: #f8f9fa; border-radius: 6px;">
                    <h3>Standard Level Practice - Great Job!</h3>
                    <p style="line-height: 1.8; text-align: left;">
                        This was the standard difficulty practice exam. ${passed ? 'You passed! 🎉' : 'Keep practicing!'}<br><br>
                        ${sectionScores['Identity and Access Management'].earned / sectionScores['Identity and Access Management'].total < 0.8 ? 
                            '• Review Identity and Access Management basics<br>' : ''}
                        ${sectionScores['Productivity Solutions'].earned / sectionScores['Productivity Solutions'].total < 0.8 ?
                            '• Study Microsoft 365 Apps features<br>' : ''}
                        ${sectionScores['Collaboration Solutions'].earned / sectionScores['Collaboration Solutions'].total < 0.8 ?
                            '• Focus on Teams, SharePoint, and OneDrive<br>' : ''}
                        <br>
                        Ready for the harder questions? Try Practice Exam #1!
                    </p>
                </div>
                
                <button class="restart-btn" onclick="location.reload()">Retake This Exam</button>
            `;
            
            resultsScreen.innerHTML = html;
        }

        window.onload = initExam;
    </script>
</body>
</html>
