<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MS-900 Practice Exam - Microsoft 365 Fundamentals</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            color: #333;
        }

        .exam-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
        }

        .header {
            background: #0078d4;
            color: white;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 20px;
            font-weight: 600;
        }

        .timer {
            font-size: 18px;
            font-weight: bold;
            padding: 8px 16px;
            background: rgba(255,255,255,0.2);
            border-radius: 4px;
        }

        .timer.warning {
            background: #dc3545;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .progress-bar {
            height: 8px;
            background: #e0e0e0;
        }

        .progress-fill {
            height: 100%;
            background: #0078d4;
            transition: width 0.3s ease;
        }

        .main-content {
            display: flex;
            min-height: calc(100vh - 150px);
        }

        .question-nav {
            width: 200px;
            background: #fafafa;
            padding: 20px;
            border-right: 1px solid #e0e0e0;
            overflow-y: auto;
        }

        .question-nav h3 {
            font-size: 14px;
            margin-bottom: 15px;
            color: #666;
        }

        .nav-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
        }

        .nav-item {
            width: 32px;
            height: 32px;
            border: 2px solid #ccc;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .nav-item:hover {
            border-color: #0078d4;
        }

        .nav-item.current {
            background: #0078d4;
            color: white;
            border-color: #0078d4;
        }

        .nav-item.answered {
            background: #28a745;
            color: white;
            border-color: #28a745;
        }

        .nav-item.flagged {
            background: #ffc107;
            color: #333;
            border-color: #ffc107;
        }

        .question-area {
            flex: 1;
            padding: 40px;
            overflow-y: auto;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e0e0e0;
        }

        .question-number {
            font-size: 16px;
            font-weight: 600;
            color: #666;
        }

        .flag-btn {
            padding: 8px 20px;
            background: white;
            border: 2px solid #ffc107;
            color: #333;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .flag-btn:hover {
            background: #ffc107;
        }

        .flag-btn.flagged {
            background: #ffc107;
        }

        .question-text {
            font-size: 18px;
            line-height: 1.6;
            margin-bottom: 30px;
            font-weight: 500;
        }

        .case-study {
            background: #f8f9fa;
            border-left: 4px solid #0078d4;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 4px;
        }

        .case-study h4 {
            margin-bottom: 15px;
            color: #0078d4;
        }

        .options {
            margin-top: 25px;
        }

        .option {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            padding: 15px 20px;
            margin-bottom: 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
        }

        .option:hover {
            border-color: #0078d4;
            background: #e7f3ff;
        }

        .option.selected {
            background: #0078d4;
            border-color: #0078d4;
            color: white;
        }

        .option input[type="radio"],
        .option input[type="checkbox"] {
            margin-right: 15px;
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .drag-drop-area {
            display: flex;
            gap: 30px;
            margin-top: 25px;
        }

        .drag-items {
            flex: 1;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 6px;
        }

        .drag-items h4 {
            margin-bottom: 15px;
            color: #666;
        }

        .drag-item {
            background: white;
            border: 2px solid #0078d4;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 4px;
            cursor: move;
            font-size: 14px;
        }

        .drop-zones {
            flex: 1;
        }

        .drop-zone {
            background: #f8f9fa;
            border: 2px dashed #ccc;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 6px;
            min-height: 50px;
        }

        .drop-zone.drag-over {
            background: #e7f3ff;
            border-color: #0078d4;
        }

        .drop-zone .drag-item {
            cursor: pointer;
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid #e0e0e0;
        }

        .nav-btn {
            padding: 12px 30px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .nav-btn.previous {
            background: #6c757d;
            color: white;
        }

        .nav-btn.previous:hover {
            background: #5a6268;
        }

        .nav-btn.previous:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .nav-btn.next {
            background: #0078d4;
            color: white;
        }

        .nav-btn.next:hover {
            background: #006cbd;
        }

        .nav-btn.submit {
            background: #28a745;
            color: white;
        }

        .nav-btn.submit:hover {
            background: #218838;
        }

        .results-screen {
            display: none;
            padding: 40px;
            text-align: center;
        }

        .results-screen.active {
            display: block;
        }

        .score-display {
            font-size: 72px;
            font-weight: bold;
            color: #0078d4;
            margin: 30px 0;
        }

        .pass-fail {
            font-size: 36px;
            font-weight: bold;
            margin: 20px 0;
        }

        .pass-fail.pass {
            color: #28a745;
        }

        .pass-fail.fail {
            color: #dc3545;
        }

        .section-breakdown {
            max-width: 800px;
            margin: 40px auto;
            text-align: left;
        }

        .section-item {
            background: #f8f9fa;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 6px;
            border-left: 4px solid #0078d4;
        }

        .section-name {
            font-weight: 600;
            margin-bottom: 10px;
        }

        .section-bar {
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 10px;
        }

        .section-bar-fill {
            height: 100%;
            background: #0078d4;
            transition: width 0.5s ease;
        }

        .restart-btn {
            margin-top: 30px;
            padding: 15px 40px;
            background: #0078d4;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
        }

        .restart-btn:hover {
            background: #006cbd;
        }

        .instructions {
            background: #fff3cd;
            border: 1px solid #ffc107;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 6px;
        }

        .instructions h3 {
            color: #856404;
            margin-bottom: 10px;
        }

        .instructions p {
            color: #856404;
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }

            .question-nav {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid #e0e0e0;
            }

            .question-area {
                padding: 20px;
            }

            .drag-drop-area {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="exam-container">
        <div class="header">
            <h1>MS-900: Microsoft 365 Fundamentals - Practice Exam</h1>
            <div class="timer" id="timer">50:00</div>
        </div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="progressBar"></div>
        </div>

        <div class="main-content" id="examContent">
            <div class="question-nav">
                <h3>Questions</h3>
                <div class="nav-grid" id="navGrid"></div>
            </div>

            <div class="question-area" id="questionArea"></div>
        </div>

        <div class="results-screen" id="resultsScreen"></div>
    </div>

    <script>
        // Exam questions data
        const examData = {
            totalTime: 50 * 60, // 50 minutes in seconds
            passingScore: 700,
            questions: [
                // SECTION 1: Identity and Access Management (Heavy focus - 15 questions)
                {
                    id: 1,
                    type: 'multiple-choice',
                    text: 'Your organization wants to ensure that users must verify their identity using two methods before accessing Microsoft 365 applications. Which feature should you implement?',
                    options: [
                        'Single Sign-On (SSO)',
                        'Multi-Factor Authentication (MFA)',
                        'Password Hash Synchronization',
                        'Self-Service Password Reset (SSPR)'
                    ],
                    correctAnswer: 1,
                    section: 'Identity and Access Management',
                    explanation: 'Multi-Factor Authentication (MFA) requires users to verify their identity using two or more verification methods, such as a password and a phone code.'
                },
                {
                    id: 2,
                    type: 'multiple-choice',
                    text: 'Which Microsoft Entra ID (formerly Azure AD) feature allows administrators to define policies that grant or block access based on conditions like user location, device state, or risk level?',
                    options: [
                        'Role-Based Access Control (RBAC)',
                        'Conditional Access',
                        'Identity Protection',
                        'Privileged Identity Management'
                    ],
                    correctAnswer: 1,
                    section: 'Identity and Access Management',
                    explanation: 'Conditional Access is a Zero Trust policy engine that allows administrators to create if-then statements for access control based on various signals and conditions.'
                },
                {
                    id: 3,
                    type: 'true-false',
                    text: 'Microsoft Entra ID (Azure AD) can synchronize with on-premises Active Directory to provide hybrid identity management.',
                    correctAnswer: true,
                    section: 'Identity and Access Management',
                    explanation: 'True. Microsoft Entra Connect (formerly Azure AD Connect) enables synchronization between on-premises Active Directory and Microsoft Entra ID for hybrid identity scenarios.'
                },
                {
                    id: 4,
                    type: 'multiple-choice',
                    text: 'A company wants to require MFA only when users sign in from outside the corporate network. Which Microsoft 365 feature should they use?',
                    options: [
                        'Security Defaults',
                        'Conditional Access policies',
                        'Identity Protection',
                        'Per-user MFA'
                    ],
                    correctAnswer: 1,
                    section: 'Identity and Access Management',
                    explanation: 'Conditional Access policies allow you to create granular rules based on conditions like location, requiring MFA only for sign-ins from untrusted locations.'
                },
                {
                    id: 5,
                    type: 'drag-drop',
                    text: 'Match each authentication method to its description:',
                    items: [
                        'Password Hash Sync',
                        'Pass-through Authentication',
                        'Federation',
                        'Seamless SSO'
                    ],
                    zones: [
                        'Synchronizes hashed passwords to the cloud',
                        'Validates passwords against on-premises AD without storing them in cloud',
                        'Redirects authentication to on-premises identity provider',
                        'Allows automatic sign-in on domain-joined devices'
                    ],
                    correctMapping: {
                        'Password Hash Sync': 'Synchronizes hashed passwords to the cloud',
                        'Pass-through Authentication': 'Validates passwords against on-premises AD without storing them in cloud',
                        'Federation': 'Redirects authentication to on-premises identity provider',
                        'Seamless SSO': 'Allows automatic sign-in on domain-joined devices'
                    },
                    section: 'Identity and Access Management'
                },
                {
                    id: 6,
                    type: 'multiple-choice',
                    text: 'Which of the following is NOT a valid MFA verification method in Microsoft Entra ID?',
                    options: [
                        'Microsoft Authenticator app notification',
                        'SMS text message code',
                        'Voice call verification',
                        'Email verification code'
                    ],
                    correctAnswer: 3,
                    section: 'Identity and Access Management',
                    explanation: 'Email is NOT a supported MFA verification method in Microsoft Entra ID. The supported methods include authenticator apps, SMS, voice calls, and hardware tokens.'
                },
                {
                    id: 7,
                    type: 'scenario',
                    scenario: 'Contoso Ltd has 500 employees. They want to implement a security policy where:\n- All users must use MFA when accessing Microsoft 365\n- External users should have limited access\n- Admin accounts need additional protection\n- Users signing in from trusted locations can skip MFA',
                    text: 'Which Microsoft 365 security feature would best meet ALL of these requirements?',
                    options: [
                        'Security Defaults',
                        'Conditional Access policies',
                        'Per-user MFA configuration',
                        'Azure AD Identity Protection'
                    ],
                    correctAnswer: 1,
                    section: 'Identity and Access Management',
                    explanation: 'Conditional Access policies provide the granular control needed to implement all these requirements, including location-based policies, user-based policies, and role-based policies.'
                },
                {
                    id: 8,
                    type: 'multiple-choice',
                    text: 'What is the primary purpose of Microsoft Entra ID (Azure AD) guest user accounts?',
                    options: [
                        'To provide full access to all organizational resources',
                        'To enable external collaboration with partners and vendors',
                        'To manage on-premises Active Directory users',
                        'To create service accounts for applications'
                    ],
                    correctAnswer: 1,
                    section: 'Identity and Access Management',
                    explanation: 'Guest user accounts in Microsoft Entra ID are specifically designed to enable secure collaboration with external users from other organizations.'
                },
                {
                    id: 9,
                    type: 'multiple-choice',
                    text: 'Which Microsoft Entra ID feature assigns administrative roles to users only when they need them, for a limited time period?',
                    options: [
                        'Role-Based Access Control (RBAC)',
                        'Conditional Access',
                        'Privileged Identity Management (PIM)',
                        'Just-In-Time Access'
                    ],
                    correctAnswer: 2,
                    section: 'Identity and Access Management',
                    explanation: 'Privileged Identity Management (PIM) provides just-in-time privileged access, requiring users to activate roles when needed for a specified time period.'
                },
                {
                    id: 10,
                    type: 'true-false',
                    text: 'Self-Service Password Reset (SSPR) in Microsoft Entra ID requires users to register at least two authentication methods.',
                    correctAnswer: true,
                    section: 'Identity and Access Management',
                    explanation: 'True. SSPR requires users to register a minimum of two authentication methods to ensure they can reset their password even if one method is unavailable.'
                },
                {
                    id: 11,
                    type: 'multiple-choice',
                    text: 'An organization wants to automatically block sign-ins from users whose credentials have been compromised. Which feature should they enable?',
                    options: [
                        'Conditional Access',
                        'Microsoft Entra ID Protection',
                        'Multi-Factor Authentication',
                        'Security Defaults'
                    ],
                    correctAnswer: 1,
                    section: 'Identity and Access Management',
                    explanation: 'Microsoft Entra ID Protection detects identity-based risks and can automatically block or require additional verification for risky sign-ins.'
                },
                {
                    id: 12,
                    type: 'multiple-select',
                    text: 'Which of the following are valid signals that Conditional Access policies can use to make access decisions? (Select all that apply)',
                    options: [
                        'User or group membership',
                        'IP location or country',
                        'Device platform (iOS, Android, Windows)',
                        'Real-time sign-in risk',
                        'User\'s favorite color'
                    ],
                    correctAnswers: [0, 1, 2, 3],
                    section: 'Identity and Access Management',
                    explanation: 'Conditional Access can use signals including user/group membership, location, device platform, application, and real-time risk detection.'
                },
                {
                    id: 13,
                    type: 'multiple-choice',
                    text: 'What is the default Microsoft Entra ID role that can create and manage all aspects of users, groups, and support tickets?',
                    options: [
                        'Global Administrator',
                        'User Administrator',
                        'Security Administrator',
                        'Helpdesk Administrator'
                    ],
                    correctAnswer: 1,
                    section: 'Identity and Access Management',
                    explanation: 'The User Administrator role can create and manage users and groups, reset passwords for non-administrators, and manage support tickets.'
                },
                {
                    id: 14,
                    type: 'scenario',
                    scenario: 'TechCorp has deployed Microsoft 365 and wants to ensure their CEO and other executives have maximum security protection. They want:\n- MFA required for every sign-in\n- Access blocked from unknown devices\n- Approval required before activating admin roles\n- Time-limited admin access',
                    text: 'Which combination of features should TechCorp implement?',
                    options: [
                        'Conditional Access + Security Defaults',
                        'Conditional Access + Privileged Identity Management (PIM)',
                        'MFA + Identity Protection',
                        'Security Defaults + RBAC'
                    ],
                    correctAnswer: 1,
                    section: 'Identity and Access Management',
                    explanation: 'Conditional Access provides the granular access controls for MFA and device requirements, while PIM provides approval workflows and time-limited admin access.'
                },
                {
                    id: 15,
                    type: 'multiple-choice',
                    text: 'Which authentication protocol is recommended by Microsoft for modern authentication in Microsoft 365?',
                    options: [
                        'Basic Authentication',
                        'NTLM',
                        'OAuth 2.0 and Modern Authentication',
                        'Kerberos'
                    ],
                    correctAnswer: 2,
                    section: 'Identity and Access Management',
                    explanation: 'OAuth 2.0 with Modern Authentication is the recommended protocol as it supports MFA, Conditional Access, and provides better security than legacy protocols.'
                },

                // SECTION 2: Productivity Solutions (12 questions)
                {
                    id: 16,
                    type: 'multiple-choice',
                    text: 'Which Microsoft 365 application is primarily used for creating professional documents with advanced formatting, styles, and templates?',
                    options: [
                        'Microsoft OneNote',
                        'Microsoft Word',
                        'Microsoft Publisher',
                        'Microsoft PowerPoint'
                    ],
                    correctAnswer: 1,
                    section: 'Productivity Solutions',
                    explanation: 'Microsoft Word is the primary word processing application in Microsoft 365, designed for creating and editing professional documents.'
                },
                {
                    id: 17,
                    type: 'drag-drop',
                    text: 'Match each Microsoft 365 app to its primary purpose:',
                    items: [
                        'Excel',
                        'PowerPoint',
                        'OneNote',
                        'Outlook'
                    ],
                    zones: [
                        'Email and calendar management',
                        'Digital note-taking and organization',
                        'Data analysis and spreadsheet creation',
                        'Creating presentations and slideshows'
                    ],
                    correctMapping: {
                        'Excel': 'Data analysis and spreadsheet creation',
                        'PowerPoint': 'Creating presentations and slideshows',
                        'OneNote': 'Digital note-taking and organization',
                        'Outlook': 'Email and calendar management'
                    },
                    section: 'Productivity Solutions'
                },
                {
                    id: 18,
                    type: 'multiple-select',
                    text: 'Which features are available in Microsoft Excel for data analysis? (Select all that apply)',
                    options: [
                        'PivotTables',
                        'Charts and graphs',
                        'Formulas and functions',
                        'Mail merge',
                        'Conditional formatting'
                    ],
                    correctAnswers: [0, 1, 2, 4],
                    section: 'Productivity Solutions',
                    explanation: 'Excel provides PivotTables, charts, formulas, and conditional formatting for data analysis. Mail merge is a Word feature.'
                },
                {
                    id: 19,
                    type: 'true-false',
                    text: 'Microsoft 365 Apps can be accessed from web browsers, desktop applications, and mobile devices.',
                    correctAnswer: true,
                    section: 'Productivity Solutions',
                    explanation: 'True. Microsoft 365 Apps are available across platforms including web (Office Online), desktop (full applications), and mobile (iOS/Android apps).'
                },
                {
                    id: 20,
                    type: 'multiple-choice',
                    text: 'Which Microsoft 365 app allows users to create and organize notes with text, images, audio recordings, and drawings across multiple devices?',
                    options: [
                        'Microsoft Word',
                        'Microsoft To Do',
                        'Microsoft OneNote',
                        'Microsoft Lists'
                    ],
                    correctAnswer: 2,
                    section: 'Productivity Solutions',
                    explanation: 'OneNote is a digital notebook that allows users to capture and organize notes in various formats including text, images, audio, and drawings.'
                },
                {
                    id: 21,
                    type: 'scenario',
                    scenario: 'Marketing team needs to:\n- Create a quarterly report with charts and tables\n- Design a presentation for stakeholders\n- Track campaign tasks and deadlines\n- Share meeting notes with the team',
                    text: 'Which Microsoft 365 apps should they use for each task, in order?',
                    options: [
                        'Word, PowerPoint, Planner, OneNote',
                        'Excel, Word, To Do, Teams',
                        'Excel, PowerPoint, Planner, OneNote',
                        'Word, Excel, Tasks, SharePoint'
                    ],
                    correctAnswer: 2,
                    section: 'Productivity Solutions',
                    explanation: 'Excel for reports with data/charts, PowerPoint for presentations, Planner for task management, and OneNote for shared meeting notes.'
                },
                {
                    id: 22,
                    type: 'multiple-choice',
                    text: 'What is the primary benefit of Microsoft 365 Copilot in productivity applications?',
                    options: [
                        'It provides antivirus protection',
                        'It uses AI to help generate content, analyze data, and automate tasks',
                        'It manages user licenses',
                        'It creates backups of documents'
                    ],
                    correctAnswer: 1,
                    section: 'Productivity Solutions',
                    explanation: 'Microsoft 365 Copilot is an AI-powered assistant that helps users create content, analyze data, and increase productivity across Microsoft 365 apps.'
                },
                {
                    id: 23,
                    type: 'multiple-choice',
                    text: 'Which Microsoft 365 app is best suited for managing and tracking project schedules, tasks, and resources with Gantt charts?',
                    options: [
                        'Microsoft Planner',
                        'Microsoft To Do',
                        'Microsoft Project',
                        'Microsoft Lists'
                    ],
                    correctAnswer: 2,
                    section: 'Productivity Solutions',
                    explanation: 'Microsoft Project is the professional project management tool with advanced features like Gantt charts, resource management, and detailed scheduling.'
                },
                {
                    id: 24,
                    type: 'true-false',
                    text: 'Microsoft Outlook can integrate with Microsoft Teams, allowing users to schedule Teams meetings directly from their Outlook calendar.',
                    correctAnswer: true,
                    section: 'Productivity Solutions',
                    explanation: 'True. Outlook and Teams are deeply integrated, allowing users to schedule and join Teams meetings directly from Outlook.'
                },
                {
                    id: 25,
                    type: 'multiple-choice',
                    text: 'Which feature in Microsoft Word helps multiple users work on the same document simultaneously?',
                    options: [
                        'Track Changes',
                        'Co-authoring (Real-time collaboration)',
                        'Comments',
                        'Version History'
                    ],
                    correctAnswer: 1,
                    section: 'Productivity Solutions',
                    explanation: 'Co-authoring allows multiple users to edit the same document at the same time, with changes appearing in real-time.'
                },
                {
                    id: 26,
                    type: 'multiple-choice',
                    text: 'What is Microsoft Bookings primarily used for?',
                    options: [
                        'Creating and managing documents',
                        'Scheduling and managing appointments with customers',
                        'Tracking project tasks',
                        'Storing and sharing files'
                    ],
                    correctAnswer: 1,
                    section: 'Productivity Solutions',
                    explanation: 'Microsoft Bookings is a scheduling tool that allows businesses to manage appointments, send confirmations, and integrate with calendars.'
                },
                {
                    id: 27,
                    type: 'multiple-select',
                    text: 'Which of the following are features of Microsoft Forms? (Select all that apply)',
                    options: [
                        'Create surveys and quizzes',
                        'Collect responses and analyze results',
                        'Real-time collaboration on surveys',
                        'Automatic grading for quizzes',
                        'Video conferencing'
                    ],
                    correctAnswers: [0, 1, 2, 3],
                    section: 'Productivity Solutions',
                    explanation: 'Forms can create surveys/quizzes, collect and analyze responses, support collaboration, and auto-grade quizzes. Video conferencing is a Teams feature.'
                },

                // SECTION 3: Collaboration Solutions (12 questions)
                {
                    id: 28,
                    type: 'multiple-choice',
                    text: 'What is the primary purpose of Microsoft Teams?',
                    options: [
                        'File storage and backup',
                        'Email management',
                        'Chat-based collaboration and meetings',
                        'Document creation'
                    ],
                    correctAnswer: 2,
                    section: 'Collaboration Solutions',
                    explanation: 'Microsoft Teams is the hub for teamwork in Microsoft 365, providing chat, video meetings, file collaboration, and app integration in one place.'
                },
                {
                    id: 29,
                    type: 'true-false',
                    text: 'When you create a Team in Microsoft Teams, a SharePoint site is automatically created to store the team\'s files.',
                    correctAnswer: true,
                    section: 'Collaboration Solutions',
                    explanation: 'True. Creating a Team automatically provisions a Microsoft 365 Group, which includes a SharePoint site for file storage.'
                },
                {
                    id: 30,
                    type: 'drag-drop',
                    text: 'Match each collaboration tool to its best use case:',
                    items: [
                        'Microsoft Teams',
                        'SharePoint',
                        'OneDrive',
                        'Yammer'
                    ],
                    zones: [
                        'Enterprise social networking and communities',
                        'Personal file storage and sharing',
                        'Team collaboration and real-time communication',
                        'Organization-wide content management and intranets'
                    ],
                    correctMapping: {
                        'Microsoft Teams': 'Team collaboration and real-time communication',
                        'SharePoint': 'Organization-wide content management and intranets',
                        'OneDrive': 'Personal file storage and sharing',
                        'Yammer': 'Enterprise social networking and communities'
                    },
                    section: 'Collaboration Solutions'
                },
                {
                    id: 31,
                    type: 'multiple-choice',
                    text: 'Which Microsoft 365 service provides personal cloud storage for each user to store their files?',
                    options: [
                        'SharePoint',
                        'OneDrive for Business',
                        'Microsoft Teams',
                        'Exchange Online'
                    ],
                    correctAnswer: 1,
                    section: 'Collaboration Solutions',
                    explanation: 'OneDrive for Business provides each user with personal cloud storage that can be accessed from any device and shared with others.'
                },
                {
                    id: 32,
                    type: 'scenario',
                    scenario: 'A company needs to:\n- Create a company-wide intranet portal\n- Host department sites with news and announcements\n- Manage document libraries with version control\n- Implement content approval workflows',
                    text: 'Which Microsoft 365 service is best suited for these requirements?',
                    options: [
                        'Microsoft Teams',
                        'OneDrive for Business',
                        'SharePoint Online',
                        'Exchange Online'
                    ],
                    correctAnswer: 2,
                    section: 'Collaboration Solutions',
                    explanation: 'SharePoint Online is designed for enterprise content management, intranet portals, team sites, and workflow automation.'
                },
                {
                    id: 33,
                    type: 'multiple-select',
                    text: 'Which features are available in Microsoft Teams? (Select all that apply)',
                    options: [
                        'Chat and instant messaging',
                        'Video and audio meetings',
                        'File sharing and collaboration',
                        'App integration (tabs, bots, connectors)',
                        'Email hosting'
                    ],
                    correctAnswers: [0, 1, 2, 3],
                    section: 'Collaboration Solutions',
                    explanation: 'Teams provides chat, meetings, file collaboration, and app integration. Email hosting is provided by Exchange Online, not Teams.'
                },
                {
                    id: 34,
                    type: 'multiple-choice',
                    text: 'What is the difference between a public team and a private team in Microsoft Teams?',
                    options: [
                        'Public teams are visible to everyone in the organization; private teams require permission to join',
                        'Public teams allow guest access; private teams do not',
                        'Public teams can have unlimited members; private teams are limited to 250',
                        'There is no difference'
                    ],
                    correctAnswer: 0,
                    section: 'Collaboration Solutions',
                    explanation: 'Public teams are discoverable and joinable by anyone in the organization, while private teams are hidden and require an invitation or approval to join.'
                },
                {
                    id: 35,
                    type: 'multiple-choice',
                    text: 'Which feature in SharePoint allows multiple users to work on the same document simultaneously?',
                    options: [
                        'Version history',
                        'Co-authoring',
                        'Check-in/Check-out',
                        'Content approval'
                    ],
                    correctAnswer: 1,
                    section: 'Collaboration Solutions',
                    explanation: 'Co-authoring enables multiple users to edit the same document at the same time, with changes syncing in real-time.'
                },
                {
                    id: 36,
                    type: 'true-false',
                    text: 'Microsoft Stream is a video streaming service that allows organizations to upload, share, and manage videos internally.',
                    correctAnswer: true,
                    section: 'Collaboration Solutions',
                    explanation: 'True. Microsoft Stream (now integrated with SharePoint) is an enterprise video service for uploading, sharing, and discovering organizational videos.'
                },
                {
                    id: 37,
                    type: 'multiple-choice',
                    text: 'What is the maximum file size that can be uploaded to OneDrive for Business?',
                    options: [
                        '100 MB',
                        '2 GB',
                        '15 GB',
                        '250 GB'
                    ],
                    correctAnswer: 3,
                    section: 'Collaboration Solutions',
                    explanation: 'OneDrive for Business supports individual file uploads up to 250 GB through the OneDrive sync client.'
                },
                {
                    id: 38,
                    type: 'scenario',
                    scenario: 'A remote team needs to:\n- Have daily standup meetings with video\n- Chat in real-time throughout the day\n- Collaborate on project files\n- Integrate task management tools',
                    text: 'Which Microsoft 365 solution provides ALL these capabilities in one platform?',
                    options: [
                        'SharePoint + OneDrive',
                        'Microsoft Teams',
                        'Yammer + Outlook',
                        'Exchange Online + Skype'
                    ],
                    correctAnswer: 1,
                    section: 'Collaboration Solutions',
                    explanation: 'Microsoft Teams is the all-in-one collaboration platform that includes meetings, chat, file collaboration, and app integration (including Planner/Tasks).'
                },
                {
                    id: 39,
                    type: 'multiple-choice',
                    text: 'Which app can be added to Microsoft Teams channels to enhance collaboration?',
                    options: [
                        'Microsoft Planner for task management',
                        'Microsoft Whiteboard for brainstorming',
                        'Power Apps for custom applications',
                        'All of the above'
                    ],
                    correctAnswer: 3,
                    section: 'Collaboration Solutions',
                    explanation: 'Teams supports integration with numerous apps including Planner, Whiteboard, Power Apps, Forms, and many third-party applications.'
                },

                // SECTION 4: Security, Compliance, and Trust (4 questions)
                {
                    id: 40,
                    type: 'multiple-choice',
                    text: 'What is the Zero Trust security model in Microsoft 365?',
                    options: [
                        'A security model that trusts all users inside the corporate network',
                        'A security model that never trusts and always verifies, regardless of location',
                        'A security model that blocks all external access',
                        'A security model that only applies to guest users'
                    ],
                    correctAnswer: 1,
                    section: 'Security and Compliance',
                    explanation: 'Zero Trust assumes breach and verifies each request as though it originates from an untrusted network, requiring continuous verification.'
                },
                {
                    id: 41,
                    type: 'multiple-select',
                    text: 'Which are components of Microsoft 365 Defender? (Select all that apply)',
                    options: [
                        'Defender for Endpoint',
                        'Defender for Office 365',
                        'Defender for Identity',
                        'Defender for Cloud Apps',
                        'Defender Antivirus'
                    ],
                    correctAnswers: [0, 1, 2, 3],
                    section: 'Security and Compliance',
                    explanation: 'Microsoft 365 Defender includes Defender for Endpoint, Office 365, Identity, and Cloud Apps. Defender Antivirus is part of Defender for Endpoint.'
                },
                {
                    id: 42,
                    type: 'multiple-choice',
                    text: 'Which Microsoft 365 compliance feature helps organizations discover, classify, and protect sensitive information?',
                    options: [
                        'Data Loss Prevention (DLP)',
                        'Retention policies',
                        'eDiscovery',
                        'Litigation hold'
                    ],
                    correctAnswer: 0,
                    section: 'Security and Compliance',
                    explanation: 'Data Loss Prevention (DLP) identifies, monitors, and automatically protects sensitive information across Microsoft 365.'
                },
                {
                    id: 43,
                    type: 'true-false',
                    text: 'Microsoft Secure Score provides recommendations to improve an organization\'s security posture and tracks progress over time.',
                    correctAnswer: true,
                    section: 'Security and Compliance',
                    explanation: 'True. Microsoft Secure Score is a measurement of security posture with actionable recommendations and tracking capabilities.'
                },

                // SECTION 5: Pricing and Licensing (2 questions)
                {
                    id: 44,
                    type: 'multiple-choice',
                    text: 'Which Microsoft 365 licensing model is most suitable for large enterprises with more than 300 users?',
                    options: [
                        'Microsoft 365 Personal',
                        'Microsoft 365 Business Basic',
                        'Microsoft 365 Enterprise (E3/E5)',
                        'Office 365 E1'
                    ],
                    correctAnswer: 2,
                    section: 'Pricing and Licensing',
                    explanation: 'Microsoft 365 Enterprise plans (E3/E5) are designed for large organizations with advanced security, compliance, and analytics needs.'
                },
                {
                    id: 45,
                    type: 'multiple-choice',
                    text: 'What is the typical billing cycle for Microsoft 365 subscriptions?',
                    options: [
                        'Weekly or bi-weekly',
                        'Monthly or annually',
                        'Quarterly only',
                        'One-time payment'
                    ],
                    correctAnswer: 1,
                    section: 'Pricing and Licensing',
                    explanation: 'Microsoft 365 subscriptions are typically billed monthly or annually, with annual commitments often providing cost savings.'
                }
            ]
        };

        // Exam state
        let currentQuestion = 0;
        let answers = {};
        let flagged = new Set();
        let timeRemaining = examData.totalTime;
        let timerInterval;
        let examStarted = false;

        // Initialize exam
        function initExam() {
            renderNavigation();
            renderQuestion();
            startTimer();
            updateProgress();
            examStarted = true;
        }

        // Timer function
        function startTimer() {
            timerInterval = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    submitExam();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            const display = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            const timerEl = document.getElementById('timer');
            timerEl.textContent = display;
            
            if (timeRemaining <= 300) { // 5 minutes warning
                timerEl.classList.add('warning');
            }
        }

        // Navigation
        function renderNavigation() {
            const navGrid = document.getElementById('navGrid');
            navGrid.innerHTML = '';
            
            examData.questions.forEach((q, index) => {
                const navItem = document.createElement('div');
                navItem.className = 'nav-item';
                navItem.textContent = index + 1;
                
                if (index === currentQuestion) {
                    navItem.classList.add('current');
                }
                if (answers[q.id] !== undefined && answers[q.id] !== null) {
                    navItem.classList.add('answered');
                }
                if (flagged.has(q.id)) {
                    navItem.classList.add('flagged');
                }
                
                navItem.onclick = () => goToQuestion(index);
                navGrid.appendChild(navItem);
            });
        }

        function goToQuestion(index) {
            currentQuestion = index;
            renderQuestion();
            renderNavigation();
            updateProgress();
        }

        function updateProgress() {
            const progress = ((currentQuestion + 1) / examData.questions.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
        }

        // Question rendering
        function renderQuestion() {
            const question = examData.questions[currentQuestion];
            const questionArea = document.getElementById('questionArea');
            
            let html = `
                <div class="question-header">
                    <div class="question-number">Question ${currentQuestion + 1} of ${examData.questions.length}</div>
                    <button class="flag-btn ${flagged.has(question.id) ? 'flagged' : ''}" onclick="toggleFlag()">
                        ${flagged.has(question.id) ? ' Flagged' : ' Flag for Review'}
                    </button>
                </div>
            `;

            if (question.scenario) {
                html += `
                    <div class="case-study">
                        <h4>Scenario</h4>
                        <p style="white-space: pre-line;">${question.scenario}</p>
                    </div>
                `;
            }

            html += `<div class="question-text">${question.text}</div>`;

            if (question.type === 'multiple-choice' || question.type === 'true-false') {
                html += '<div class="options">';
                const options = question.type === 'true-false' ? ['True', 'False'] : question.options;
                options.forEach((option, index) => {
                    const isSelected = question.type === 'true-false' 
                        ? answers[question.id] === (index === 0)
                        : answers[question.id] === index;
                    
                    html += `
                        <div class="option ${isSelected ? 'selected' : ''}" onclick="selectOption(${index})">
                            <input type="radio" name="q${question.id}" ${isSelected ? 'checked' : ''}>
                            <span>${option}</span>
                        </div>
                    `;
                });
                html += '</div>';
            } else if (question.type === 'multiple-select') {
                html += '<div class="instructions"><h3>Instructions</h3><p>Select all answers that apply.</p></div>';
                html += '<div class="options">';
                question.options.forEach((option, index) => {
                    const isSelected = answers[question.id]?.includes(index) || false;
                    html += `
                        <div class="option ${isSelected ? 'selected' : ''}" onclick="toggleMultiSelect(${index})">
                            <input type="checkbox" ${isSelected ? 'checked' : ''}>
                            <span>${option}</span>
                        </div>
                    `;
                });
                html += '</div>';
            } else if (question.type === 'drag-drop') {
                html += `
                    <div class="instructions">
                        <h3>Instructions</h3>
                        <p>Drag items from the left to match them with the correct descriptions on the right.</p>
                    </div>
                    <div class="drag-drop-area">
                        <div class="drag-items">
                            <h4>Items to Match</h4>
                            <div id="dragItems"></div>
                        </div>
                        <div class="drop-zones">
                            <h4>Descriptions</h4>
                            <div id="dropZones"></div>
                        </div>
                    </div>
                `;
            } else if (question.type === 'scenario') {
                html += '<div class="options">';
                question.options.forEach((option, index) => {
                    const isSelected = answers[question.id] === index;
                    html += `
                        <div class="option ${isSelected ? 'selected' : ''}" onclick="selectOption(${index})">
                            <input type="radio" name="q${question.id}" ${isSelected ? 'checked' : ''}>
                            <span>${option}</span>
                        </div>
                    `;
                });
                html += '</div>';
            }

            html += `
                <div class="navigation-buttons">
                    <button class="nav-btn previous" onclick="previousQuestion()" ${currentQuestion === 0 ? 'disabled' : ''}>
                         Previous
                    </button>
                    ${currentQuestion === examData.questions.length - 1 
                        ? '<button class="nav-btn submit" onclick="confirmSubmit()">Submit Exam</button>'
                        : '<button class="nav-btn next" onclick="nextQuestion()">Next </button>'
                    }
                </div>
            `;

            questionArea.innerHTML = html;

            if (question.type === 'drag-drop') {
                renderDragDrop(question);
            }
        }

        function renderDragDrop(question) {
            const dragItems = document.getElementById('dragItems');
            const dropZones = document.getElementById('dropZones');
            
            // Initialize answers if not exists
            if (!answers[question.id]) {
                answers[question.id] = {};
            }
            
            // Render items
            const usedItems = new Set(Object.keys(answers[question.id]));
            question.items.forEach(item => {
                if (!usedItems.has(item)) {
                    const div = document.createElement('div');
                    div.className = 'drag-item';
                    div.draggable = true;
                    div.textContent = item;
                    div.ondragstart = (e) => e.dataTransfer.setData('text', item);
                    dragItems.appendChild(div);
                }
            });
            
            // Render zones
            question.zones.forEach(zone => {
                const div = document.createElement('div');
                div.className = 'drop-zone';
                div.innerHTML = `<strong>${zone}</strong>`;
                
                // Check if this zone already has an item
                const assignedItem = Object.keys(answers[question.id]).find(
                    item => answers[question.id][item] === zone
                );
                
                if (assignedItem) {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'drag-item';
                    itemDiv.draggable = true;
                    itemDiv.textContent = assignedItem;
                    itemDiv.ondragstart = (e) => {
                        e.dataTransfer.setData('text', assignedItem);
                        delete answers[question.id][assignedItem];
                    };
                    itemDiv.onclick = () => {
                        delete answers[question.id][assignedItem];
                        renderQuestion();
                    };
                    div.appendChild(itemDiv);
                }
                
                div.ondragover = (e) => {
                    e.preventDefault();
                    div.classList.add('drag-over');
                };
                div.ondragleave = () => div.classList.remove('drag-over');
                div.ondrop = (e) => {
                    e.preventDefault();
                    div.classList.remove('drag-over');
                    const item = e.dataTransfer.getData('text');
                    answers[question.id][item] = zone;
                    renderQuestion();
                    renderNavigation();
                };
                
                dropZones.appendChild(div);
            });
        }

        function selectOption(index) {
            const question = examData.questions[currentQuestion];
            answers[question.id] = index;
            renderQuestion();
            renderNavigation();
        }

        function toggleMultiSelect(index) {
            const question = examData.questions[currentQuestion];
            if (!answers[question.id]) {
                answers[question.id] = [];
            }
            
            const answerIndex = answers[question.id].indexOf(index);
            if (answerIndex > -1) {
                answers[question.id].splice(answerIndex, 1);
            } else {
                answers[question.id].push(index);
            }
            
            renderQuestion();
            renderNavigation();
        }

        function toggleFlag() {
            const question = examData.questions[currentQuestion];
            if (flagged.has(question.id)) {
                flagged.delete(question.id);
            } else {
                flagged.add(question.id);
            }
            renderQuestion();
            renderNavigation();
        }

        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                renderQuestion();
                renderNavigation();
                updateProgress();
            }
        }

        function nextQuestion() {
            if (currentQuestion < examData.questions.length - 1) {
                currentQuestion++;
                renderQuestion();
                renderNavigation();
                updateProgress();
            }
        }

        function confirmSubmit() {
            const unanswered = examData.questions.filter(q => 
                answers[q.id] === undefined || answers[q.id] === null || 
                (Array.isArray(answers[q.id]) && answers[q.id].length === 0) ||
                (typeof answers[q.id] === 'object' && Object.keys(answers[q.id]).length === 0)
            ).length;
            
            let message = 'Are you sure you want to submit your exam?';
            if (unanswered > 0) {
                message += `\n\nYou have ${unanswered} unanswered question(s).`;
            }
            
            if (confirm(message)) {
                submitExam();
            }
        }

        function submitExam() {
            clearInterval(timerInterval);
            
            // Calculate score
            let totalPoints = 0;
            let earnedPoints = 0;
            const sectionScores = {};
            
            examData.questions.forEach(question => {
                totalPoints += 1000 / examData.questions.length;
                
                if (!sectionScores[question.section]) {
                    sectionScores[question.section] = { total: 0, earned: 0 };
                }
                sectionScores[question.section].total += 1;
                
                let isCorrect = false;
                
                if (question.type === 'multiple-choice' || question.type === 'scenario') {
                    isCorrect = answers[question.id] === question.correctAnswer;
                } else if (question.type === 'true-false') {
                    isCorrect = answers[question.id] === question.correctAnswer;
                } else if (question.type === 'multiple-select') {
                    const userAnswers = answers[question.id] || [];
                    isCorrect = JSON.stringify(userAnswers.sort()) === JSON.stringify(question.correctAnswers.sort());
                } else if (question.type === 'drag-drop') {
                    const userMapping = answers[question.id] || {};
                    isCorrect = Object.keys(question.correctMapping).every(
                        item => userMapping[item] === question.correctMapping[item]
                    );
                }
                
                if (isCorrect) {
                    earnedPoints += 1000 / examData.questions.length;
                    sectionScores[question.section].earned += 1;
                }
            });
            
            const finalScore = Math.round(earnedPoints);
            const passed = finalScore >= examData.passingScore;
            
            // Display results
            displayResults(finalScore, passed, sectionScores);
        }

        function displayResults(score, passed, sectionScores) {
            document.getElementById('examContent').style.display = 'none';
            const resultsScreen = document.getElementById('resultsScreen');
            resultsScreen.classList.add('active');
            
            let html = `
                <h2>Exam Complete!</h2>
                <div class="score-display">${score}</div>
                <div class="pass-fail ${passed ? 'pass' : 'fail'}">
                    ${passed ? ' PASSED' : ' DID NOT PASS'}
                </div>
                <p style="font-size: 18px; margin: 20px 0;">
                    Passing Score: ${examData.passingScore} | Your Score: ${score}
                </p>
                
                <div class="section-breakdown">
                    <h3 style="margin-bottom: 20px;">Performance by Section</h3>
            `;
            
            Object.keys(sectionScores).forEach(section => {
                const data = sectionScores[section];
                const percentage = (data.earned / data.total * 100).toFixed(1);
                html += `
                    <div class="section-item">
                        <div class="section-name">${section}</div>
                        <div>${data.earned} of ${data.total} correct (${percentage}%)</div>
                        <div class="section-bar">
                            <div class="section-bar-fill" style="width: ${percentage}%"></div>
                        </div>
                    </div>
                `;
            });
            
            html += `
                </div>
                
                <div style="margin-top: 40px; padding: 20px; background: #f8f9fa; border-radius: 6px;">
                    <h3>Recommendations for Mokenyu:</h3>
                    <p style="line-height: 1.8; text-align: left;">
                        Based on your performance, focus on:<br><br>
                        ${sectionScores['Identity and Access Management'].earned / sectionScores['Identity and Access Management'].total < 0.7 ? 
                            ' <strong>Identity and Access Management</strong>: Review Azure AD, MFA, Conditional Access, and authentication methods<br>' : ''}
                        ${sectionScores['Productivity Solutions'].earned / sectionScores['Productivity Solutions'].total < 0.7 ?
                            ' <strong>Productivity Solutions</strong>: Study Microsoft 365 Apps features and capabilities<br>' : ''}
                        ${sectionScores['Collaboration Solutions'].earned / sectionScores['Collaboration Solutions'].total < 0.7 ?
                            ' <strong>Collaboration Solutions</strong>: Focus on Teams, SharePoint, and OneDrive integration<br>' : ''}
                        <br>
                        Keep practicing and review Microsoft Learn modules for these topics!
                    </p>
                </div>
                
                <button class="restart-btn" onclick="location.reload()">Take Another Practice Exam</button>
            `;
            
            resultsScreen.innerHTML = html;
        }

        // Start exam on load
        window.onload = initExam;
    </script>
</body>
</html>
